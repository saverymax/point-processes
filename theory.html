<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Thinned Nonhomogenous Poisson Processes for Presence-Only data - 2&nbsp; Poisson process theory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data_generation.html" rel="next">
<link href="./introduction.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poisson process theory</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Thinned Nonhomogenous Poisson Processes for Presence-Only data</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theory.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poisson process theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_generation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Presence-only data generation</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poisson process theory</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The poisson process describes a set of points <span class="math inline">\(S\)</span> where <span class="math inline">\(\{s_i\} \subseteq D\)</span> with intensity <span class="math inline">\(\lambda\)</span>. Given an area or quadrat called subregion <span class="math inline">\(A\)</span> of <span class="math inline">\(D\)</span> of size <span class="math inline">\(|A|\)</span> centered around site <span class="math inline">\(s_i\)</span> we can model the number of individuals occurring at that site <span class="math inline">\(N_{s}(A)\)</span> with a poisson distribution. This distribution will have mean <span class="math display">\[
\Lambda(A) = \int\lambda(s)ds
\]</span> For the demonstration here, we assume <span class="math inline">\(|A|=1\)</span>. However, the parameters in the Poisson Point Process are invariant to the scale of the data.</p>
<p>Typically, we model the intensity with a log-linear function, for example with parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, <span class="math display">\[
\lambda(s) = \exp[\alpha + \beta'x(s)]
\]</span> so that the expected number of observations in region A is now <span class="math display">\[
\Lambda(A) = \int_A\exp[\alpha + \beta'x(s)]ds
\]</span> We quickly notice that this integral is intractable and we will need a method of numerical integration. Indeed this will be discussed and explored here.</p>
<p>Consider, however, that we are going to be dealing with environmental data with environmental covariates, which are going to be discretized at some resolution inherently. Therefore, we can think of the inhomogenous poisson process as a continuous limit of a discretized set of conditionally independent poisson random variables, where the IPP emerges as the discretization grows smaller, i.e., <span class="math inline">\(\Lambda(ds), ds\to 0\)</span>. In fact, using this continuous limit is how the likelihood for the PP can be derived (Banerjee, 2014. p203-4). However, considering that we will be working in a discretized space, the continuous framework ends up being less practically useful.</p>
<p>We now define the likelihood for the NHPP (Banerjee, 2014, p214) <span class="math display">\[
f(s_1, s_2...s_n|N(D)=n) = \prod_i\frac{\lambda(s_i)}{(\lambda(D))^n}
\]</span> and the joint density will be <span class="math display">\[
f(s_1, s_2...s_n,N(D)=n) = \prod_i\frac{\lambda(s_i)}{(\lambda(D))^n}\left[(\lambda(D))^n\frac{\exp(-\lambda(D))}{n!}\right]
\]</span> where we can see the second term on the right corresponds to the poisson likelihood for the number of total observations in space <span class="math inline">\(D\)</span>. The likelihood will then be <span class="math display">\[
L(\lambda(s)|s_1, s_2,...,s_n) = \prod_i\lambda(s_i)\frac{\exp(-\lambda(D))}{n!}
\]</span> We can move between the continuous and discrete versions of this likelihood by partitioning <span class="math inline">\(D\)</span> into a grid of <span class="math inline">\(c\)</span> cells and taking the poisson likelihood <span class="math display">\[\begin{equation}
\label{eq:pp-l}
L(\lambda) = \prod_c(\lambda(A_c))^{N(A_c)}\exp(-\lambda(A_c))
\end{equation}\]</span> Noticing that we can sum all the exponents, we get <span class="math display">\[
L(\lambda) = \prod_c(\lambda(A_c))^{N(A_c)}\exp(-[\lambda(A_1) + \lambda(A_2) + \cdots+\lambda(A_c)) = \prod_c(\lambda(A_c))^{N(A_c)}\exp(-\lambda(D)]
\]</span> and <span class="math inline">\(N(A_c) = 1/0, |A_c|\to 0\)</span>. The term on the right indeed reduces to <span class="math inline">\(\ref{eq:pp-l}\)</span>. We can then safely work with the Poisson likelihood given our grid is fine enough. This will be explored later.</p>
<p>We still have, however, one issue. We originally defined the mean of the of region <span class="math inline">\(A\)</span> according to the properties of the PP, <span class="math display">\[
\Lambda(A) = \int_A\lambda(s)ds= \int_A\exp[\alpha + \beta'x(s)]ds
\]</span> Suddenly we are saying that we can just work with the intensity for region <span class="math inline">\(A\)</span> without clarifying what we should do about the integral over the functional for intensity. Unfortunately, while we may want the integral over <span class="math inline">\(s\)</span>, we don’t have information at the resolution of <span class="math inline">\(ds\)</span>. All we have are covariates <span class="math inline">\(\beta'X\)</span>. That is, <span class="math display">\[
\int_A\exp[\alpha + \beta'x(s)]ds \approx |A|\exp[\alpha + \beta'x]
\]</span> Notice that we no longer have <span class="math inline">\(x(s)\)</span>. We assume the covariate information is relative constant over region <span class="math inline">\(A\)</span>. If this doesn’t hold, our approximation will not be correct. But, given that it is all the information we have, the assumption is built into any modelling procedure and is less an issue with the Poisson Process and more just an issue of covariate resolution which is a common modelling issue in spatial-temporal statistics. As is stated in Banerjee, 2014 (p216) “In the absence of finer covariate resolution, we cannot do better with regard to the ecological fallacy.”</p>
<p>Also, originally, we mentioned that it is convenient to assume <span class="math inline">\(|A| = 1\)</span>. This is now the reason, so we don’t have to worry about the scaling factor.</p>
<p>Given this approximation and scaling assumption, we now have <span class="math display">\[
\Lambda(A) = \int_A\exp[\alpha + \beta'x(s)]ds \approx |A|\exp[\alpha + \beta'x] = \frac{|D|}{c}\exp[\alpha + \beta'x]
\]</span> where <span class="math inline">\(c\)</span> is the number of cells and <span class="math inline">\(|D|\)</span> is our total area. Then the counts in subregion <span class="math inline">\(A\)</span> will be distributed as <span class="math display">\[
N(A_i) \sim Poisson\left(\frac{|D|}{c}\exp[\alpha + \beta'x_i]\right) = Poisson\left(\exp[\alpha + \beta'x_i]\right)
\]</span> if the number of cells is equal to the area <span class="math inline">\((|A| = 1)\)</span>. Based on this, we end up with the log-likelihood for our entire presence-only dataset: <span class="math display">\[
l(\alpha, \beta) = \sum_{i\in B}N(A_i)(\alpha + \beta'x_i) - \frac{|D|}{c}\sum_{i\in B}\exp[\alpha + \beta'x_i] - \sum_{i\in B}\log(N(A_i))!
\]</span> where <span class="math inline">\(i\in B\)</span> refers to the set of background points <span class="math inline">\(B={1,2,...,c}\)</span>. We take this likelihood over the entire set of background points in order to appropriately estimate the integral <span class="math display">\[
\Lambda(D) = \int_D\lambda(s)ds
\]</span> We need all points in the grid to approximate the integral, as is clear in the original likelihood. Thus, we have defined our model and the likelihood that we can use for PO data.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./introduction.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./data_generation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Presence-only data generation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>